<!DOCTYPE html><HTML lang="en"><head><meta charset="UTF-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Missing values · Mill</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script data-main="../../assets/documenter.js" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" data-theme-name="documenter-dark" href="../../assets/themes/documenter-dark.css" rel="stylesheet" type="text/css"/><link class="docs-theme-link" data-theme-name="documenter-light" data-theme-primary="" href="../../assets/themes/documenter-light.css" rel="stylesheet" type="text/css"/><script src="../../assets/themeswap.js"></script><script data-is-old-version="">document.addEventListener("DOMContentLoaded", function () {
    if (document.body.querySelector('meta[name="robots"]') === null) {
        const meta = document.createElement('meta');
        meta.name = 'robots';
        meta.content = 'noindex';

        document.getElementsByTagName('head')[0].appendChild(meta);
    };

    const div = document.createElement('div');
    div.setAttribute('style', 'position: fixed; width: 100%; top: 0; left: 0; box-shadow: 0 0 10px rgba(0,0,0,0.3); z-index: 999; background-color: #ffaf9c; color: rgba(0, 0, 0, 0.7); border-bottom: 1px solid #d54625; padding: 10px 35px; text-align: center; font-size: 15px;');
    const closer = document.createElement('div');
    closer.setAttribute('style', 'position: absolute; top: calc(50% - 8px); right: 18px; cursor: pointer; width: 12px;');
    // Icon by font-awesome (license: https://fontawesome.com/license, link: https://fontawesome.com/icons/times?style=solid)
    closer.innerHTML = '<svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" class="svg-inline--fa fa-times fa-w-11" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512"><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg>';
    closer.addEventListener('click', function () {
        document.body.removeChild(div);
    });
    let href = '/stable';
    if (window.documenterBaseURL) {
        href = window.documenterBaseURL + '/../stable';
    }
    div.innerHTML = 'This is an old version of the documentation. <br> <a href="' + href + '" style="color: rgb(46, 99, 184)">Go to the newest version</a>.';
    div.appendChild(closer);
    document.body.appendChild(div);
});
</script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Mill</span></div><form action="../../search/" class="docs-search"><input class="docs-search-query" id="documenter-search-query" name="q" placeholder="Search docs" type="text"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/simple/">Simple</a></li><li><a class="tocitem" href="../../examples/advanced/">Advanced</a></li><li><a class="tocitem" href="../../examples/graphs/">GNN in 16 lines</a></li><li><a class="tocitem" href="../../examples/dag/">DAGs</a></li></ul></li><li><span class="tocitem">Architecture of Mill</span><ul><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../reflectin/">ReflectInModel</a></li><li><a class="tocitem" href="../strings/">Handling strings</a></li><li><a class="tocitem" href="../aggregation/">Aggregations</a></li><li class="is-active"><a class="tocitem" href="">Missing values</a><ul class="internal"><li><a class="tocitem" href="#Representing-missing-values"><span>Representing missing values</span></a></li></ul></li><li><a class="tocitem" href="../custom/">Custom Nodes</a></li></ul></li><li><span class="tocitem">Helper tools</span><ul><li><a class="tocitem" href="../../tools/hierarchical/">HierarichalUtils.jl</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Architecture of Mill</a></li><li class="is-active"><a href="">Missing values</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="">Missing values</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/pevnak/Mill.jl/blob/master/docs/src/architecture/missing.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" href="#" id="documenter-settings-button" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" href="#" id="documenter-sidebar-button"></a></div></header><article class="content" id="documenter-page"><h1 id="Missing-values"><a class="docs-heading-anchor" href="#Missing-values">Missing values</a><a id="Missing-values-1"></a><a class="docs-heading-anchor-permalink" href="#Missing-values" title="Permalink"></a></h1><p>At the moment, Mill.jl features an initial and naive approach to missing values. We assume that <code>ArrayNode</code> have missing values replaced by zeros, which is not optimal but in many situations it works reasonably well.</p><p>BagNodes with missing features are indicated by Bags being set to <code>[0:-1]</code> with <code>missing</code> as a data and metadata. This can be seamlessly concatenated or sub-set, if the operation makes sense.</p><p>Couple examples from unit tests. Let's define full and empty BagNode</p><pre><code class="language-none">julia&gt; a = BagNode(ArrayNode(rand(3,4)),[1:4], nothing)
BagNode with 1 bag(s)
  └── ArrayNode(3, 4)

julia&gt; e = BagNode(missing, AlignedBags([0:-1]), nothing)
BagNode with 1 empty bag(s)</code></pre><p>We can concatenate them as follows.</p><pre><code class="language-none">julia&gt; x = reduce(catobs,[a, e])
BagNode with 2 bag(s)
  └── ArrayNode(3, 4)</code></pre><p>Notice, that the ArrayNode has still the same dimension as ArrayNode of just <code>a</code>. The missing second element, corresponding to <code>e</code> is indicated by the second bags being <code>0:-1</code> as follows:</p><pre><code class="language-none">julia&gt; x.bags
AlignedBags(UnitRange{Int64}[1:4, 0:-1])</code></pre><p>We can get back the missing second element as</p><pre><code class="language-none">julia&gt; x[2]
BagNode with 1 empty bag(s)</code></pre><p>During forward (and backward) pass, the missing values in BagNodes are filled in aggregation by zeros. ** In order this feature to work, the <code>Aggregation</code> needs to know dimension, therefore use MissingAggregation, which can handle this.** In the future, MissingAggregation will be made default.</p><p>Last but not least, <code>ProductNode</code>s cannot handle missing values, as the missingness is propagated to its leaves, i.e.</p><pre><code class="language-none">julia&gt; ProductNode((a,e))
ProductNode{2}
  ├── BagNode with 1 bag(s)
  │     └── ArrayNode(3, 4)
  └── BagNode with 1 empty bag(s)</code></pre><h2 id="Representing-missing-values"><a class="docs-heading-anchor" href="#Representing-missing-values">Representing missing values</a><a id="Representing-missing-values-1"></a><a class="docs-heading-anchor-permalink" href="#Representing-missing-values" title="Permalink"></a></h2><p>The library currently support two ways to represent bags with missing values. First one represent missing data using <code>missing</code> as <code>a = BagNode(missing, [0:-1])</code> while the second as an empty vector as <code>a = BagNode(zero(4,0), [0:-1])</code>.  While off the shelf the library supports both approaches transparently, the difference is mainly when one uses getindex, and therefore there is a switch <code>Mill.emptyismissing(false)</code>, which is by default false. Let me demonstrate the difference.</p><pre><code class="language-julia">julia&gt; a = BagNode(ArrayNode(rand(3,2)), [1:2, 0:-1])
BagNode with 2 bag(s)
  └── ArrayNode(3, 2)

julia&gt; Mill.emptyismissing(false);

julia&gt; a[2].data
ArrayNode(3, 0)

julia&gt; Mill.emptyismissing(true)
true

julia&gt; a[2].data
missing</code></pre><p>The advantage of the first approach, default, is that types are always the same, which is nice to the compiler (and Zygote). The advantage of the latter is that it is more compact and nicer.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../aggregation/">« Aggregations</a><a class="docs-footer-nextpage" href="../custom/">Custom Nodes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label></p><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div><p></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 9 December 2020 19:10">Wednesday 9 December 2020</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></HTML>