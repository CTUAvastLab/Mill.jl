<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data in leaves · Mill.jl</title><meta name="title" content="Data in leaves · Mill.jl"/><meta property="og:title" content="Data in leaves · Mill.jl"/><meta property="twitter:title" content="Data in leaves · Mill.jl"/><meta name="description" content="Documentation for Mill.jl."/><meta property="og:description" content="Documentation for Mill.jl."/><meta property="twitter:description" content="Documentation for Mill.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="Mill.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="Mill.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../motivation/">Motivation</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../nodes/">Nodes</a></li><li><a class="tocitem" href="../more_on_nodes/">More on nodes</a></li><li><a class="tocitem" href="../reflectin/">Model reflection</a></li><li><a class="tocitem" href="../aggregation/">Bag aggregation</a></li><li class="is-active"><a class="tocitem" href>Data in leaves</a><ul class="internal"><li><a class="tocitem" href="#Numerical-features"><span>Numerical features</span></a></li><li><a class="tocitem" href="#Categorical-features"><span>Categorical features</span></a></li><li><a class="tocitem" href="#Strings"><span>Strings</span></a></li><li><a class="tocitem" href="#Putting-it-all-together"><span>Putting it all together</span></a></li></ul></li><li><a class="tocitem" href="../missing/">Missing data</a></li><li><a class="tocitem" href="../custom/">Custom nodes</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/musk/musk/">Musk</a></li><li><a class="tocitem" href="../../examples/jsons/">Processing JSONs</a></li><li><a class="tocitem" href="../../examples/gnn/">GNNs in 16 lines</a></li><li><a class="tocitem" href="../../examples/dag/">DAGs</a></li></ul></li><li><span class="tocitem">External tools</span><ul><li><a class="tocitem" href="../../tools/hierarchical/">HierarchicalUtils.jl</a></li></ul></li><li><span class="tocitem">Public API</span><ul><li><a class="tocitem" href="../../api/aggregation/">Aggregation</a></li><li><a class="tocitem" href="../../api/bags/">Bags</a></li><li><a class="tocitem" href="../../api/data_nodes/">Data nodes</a></li><li><a class="tocitem" href="../../api/model_nodes/">Model nodes</a></li><li><a class="tocitem" href="../../api/special_arrays/">Special Arrays</a></li><li><a class="tocitem" href="../../api/switches/">Switches</a></li><li><a class="tocitem" href="../../api/utilities/">Utilities</a></li></ul></li><li><a class="tocitem" href="../../references/">References</a></li><li><a class="tocitem" href="../../citation/">Citation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Data in leaves</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Data in leaves</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CTUAvastLab/Mill.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CTUAvastLab/Mill.jl/blob/master/docs/src/manual/leaf_data.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Data-in-leaves"><a class="docs-heading-anchor" href="#Data-in-leaves">Data in leaves</a><a id="Data-in-leaves-1"></a><a class="docs-heading-anchor-permalink" href="#Data-in-leaves" title="Permalink"></a></h1><p>In <a href="https://github.com/CTUAvastLab/Mill.jl"><code>Mill.jl</code></a> tree-like data representations, there are always some raw data on the leaf level, whereas on higher levels instances are grouped into bags (<a href="../../api/data_nodes/#Mill.BagNode"><code>BagNode</code></a>s), and different sets are joined together with Cartesion products (<a href="../../api/data_nodes/#Mill.ProductNode"><code>ProductNode</code></a>s) and thus more abstract concepts are created. In this section we look into several examples how the lowest-level data can be represented.</p><p>For this purpose, let&#39;s assume that we would like to identify infected clients in a network from their HTTP traffic. Since one client can make an arbitrary number of connections during the observation period, modelling the client as a <em>bag</em> of connections seems like the most natural approach:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; connections = AlignedBags([1:2, 3:3, 4:6])</code><code class="nohighlight hljs ansi" style="display:block;">AlignedBags{Int64}(UnitRange{Int64}[1:2, 3:3, 4:6])</code></pre><p>Thus, each of the six connections becomes an <em>instance</em> in one of the three bags representing clients. How to represent such connections instances? Each HTTP flow has properties that can be expressed as standard numerical features, categorical features or strings of characters.</p><h2 id="Numerical-features"><a class="docs-heading-anchor" href="#Numerical-features">Numerical features</a><a id="Numerical-features-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-features" title="Permalink"></a></h2><p>We have already shown how to represent standard numerical features in previous parts of this manual. It is as simple as wrapping a type that behaves like a matrix into an <a href="../../api/data_nodes/#Mill.ArrayNode"><code>ArrayNode</code></a>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; content_lengths = [4446, 1957, 4310,
                          11604, 17019, 13947]</code><code class="nohighlight hljs ansi" style="display:block;">6-element Vector{Int64}:
  4446
  1957
  4310
 11604
 17019
 13947</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dates = [1435420950, 1376190532, 1316869962,
                1302775198, 1555598383, 1562237892]</code><code class="nohighlight hljs ansi" style="display:block;">6-element Vector{Int64}:
 1435420950
 1376190532
 1316869962
 1302775198
 1555598383
 1562237892</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; numerical_node = ArrayNode([content_lengths&#39;; dates&#39;])</code><code class="nohighlight hljs ansi" style="display:block;">2×6 ArrayNode{Matrix{Int64}, Nothing}:
       4446        1957        4310       11604       17019       13947
 1435420950  1376190532  1316869962  1302775198  1555598383  1562237892</code></pre><p>We use <code>Content-Length</code>  and <code>Date</code> request headers, the latter converted to Unix timestamp.</p><h2 id="Categorical-features"><a class="docs-heading-anchor" href="#Categorical-features">Categorical features</a><a id="Categorical-features-1"></a><a class="docs-heading-anchor-permalink" href="#Categorical-features" title="Permalink"></a></h2><p>For categorical variables, we proceed in the same way, but we use one-hot encoding implemented in <a href="https://fluxml.ai"><code>Flux.jl</code></a>. This way, we can encode for example a verb of the request:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ALL_VERBS = [&quot;GET&quot;, &quot;HEAD&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;] # etc...</code><code class="nohighlight hljs ansi" style="display:block;">5-element Vector{String}:
 &quot;GET&quot;
 &quot;HEAD&quot;
 &quot;POST&quot;
 &quot;PUT&quot;
 &quot;DELETE&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; verbs = [&quot;GET&quot;, &quot;GET&quot;, &quot;POST&quot;, &quot;HEAD&quot;, &quot;HEAD&quot;, &quot;PUT&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">6-element Vector{String}:
 &quot;GET&quot;
 &quot;GET&quot;
 &quot;POST&quot;
 &quot;HEAD&quot;
 &quot;HEAD&quot;
 &quot;PUT&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; verb_node = ArrayNode(Flux.onehotbatch(verbs, ALL_VERBS))</code><code class="nohighlight hljs ansi" style="display:block;">5×6 ArrayNode{OneHotArrays.OneHotMatrix{UInt32, Vector{UInt32}}, Nothing}:
 1  1  ⋅  ⋅  ⋅  ⋅
 ⋅  ⋅  ⋅  1  1  ⋅
 ⋅  ⋅  1  ⋅  ⋅  ⋅
 ⋅  ⋅  ⋅  ⋅  ⋅  1
 ⋅  ⋅  ⋅  ⋅  ⋅  ⋅</code></pre><p>or <code>Content-Encoding</code> header:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ALL_ENCODINGS = [&quot;bzip2&quot;, &quot;gzip&quot;, &quot;xz&quot;, &quot;identity&quot;] # etc...</code><code class="nohighlight hljs ansi" style="display:block;">4-element Vector{String}:
 &quot;bzip2&quot;
 &quot;gzip&quot;
 &quot;xz&quot;
 &quot;identity&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; encodings = [&quot;xz&quot;, &quot;gzip&quot;, &quot;bzip2&quot;, &quot;xz&quot;, &quot;identity&quot;, &quot;bzip2&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">6-element Vector{String}:
 &quot;xz&quot;
 &quot;gzip&quot;
 &quot;bzip2&quot;
 &quot;xz&quot;
 &quot;identity&quot;
 &quot;bzip2&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; encoding_node = ArrayNode(Flux.onehotbatch(encodings, ALL_ENCODINGS))</code><code class="nohighlight hljs ansi" style="display:block;">4×6 ArrayNode{OneHotArrays.OneHotMatrix{UInt32, Vector{UInt32}}, Nothing}:
 ⋅  ⋅  1  ⋅  ⋅  1
 ⋅  1  ⋅  ⋅  ⋅  ⋅
 1  ⋅  ⋅  1  ⋅  ⋅
 ⋅  ⋅  ⋅  ⋅  1  ⋅</code></pre><p>Because <code>Flux.OneHotMatrix</code> supports multiplication it is possible to wrap it into an <a href="../../api/data_nodes/#Mill.ArrayNode"><code>ArrayNode</code></a>.</p><h2 id="Strings"><a class="docs-heading-anchor" href="#Strings">Strings</a><a id="Strings-1"></a><a class="docs-heading-anchor-permalink" href="#Strings" title="Permalink"></a></h2><p>The last example we will consider are string features. This could for example be the <code>Host</code> header:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; hosts = [
           &quot;www.foo.com&quot;, &quot;www.foo.com&quot;, &quot;www.baz.com&quot;,
           &quot;www.foo.com&quot;, &quot;www.baz.com&quot;, &quot;www.foo.com&quot;
       ]</code><code class="nohighlight hljs ansi" style="display:block;">6-element Vector{String}:
 &quot;www.foo.com&quot;
 &quot;www.foo.com&quot;
 &quot;www.baz.com&quot;
 &quot;www.foo.com&quot;
 &quot;www.baz.com&quot;
 &quot;www.foo.com&quot;</code></pre><p><a href="https://github.com/CTUAvastLab/Mill.jl"><code>Mill.jl</code></a> offers <code>n</code>gram histogram-based representation for strings. To get started, we pass the vector of strings into the constructor of     <a href="../../api/special_arrays/#Mill.NGramMatrix"><code>NGramMatrix</code></a>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; hosts_ngrams = NGramMatrix(hosts, 3, 256, 7)</code><code class="nohighlight hljs ansi" style="display:block;">7×6 NGramMatrix{String, Vector{String}, Int64}:
 &quot;www.foo.com&quot;
 &quot;www.foo.com&quot;
 &quot;www.baz.com&quot;
 &quot;www.foo.com&quot;
 &quot;www.baz.com&quot;
 &quot;www.foo.com&quot;</code></pre><p>Each string gets processed into <code>n</code>grams (trigram in this case as specified in the first parameter). Then, each character is transformed into an integer via the <code>codeunits</code> function and the whole trigram is interpreted as a three digit number using a base <code>b</code> specified in the second parameter. Here, we use a base of <code>256</code>, which is the most reasonable choice for ascii URLs. For example, for <code>foo</code> trigram, we obtain:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; c = codeunits(&quot;foo&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">3-element Base.CodeUnits{UInt8, String}:
 0x66
 0x6f
 0x6f</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; c[1] * 256^2 + c[2] * 256 + c[3]</code><code class="nohighlight hljs ansi" style="display:block;">6713199</code></pre><p>The last step is taking the modulo of this result with respect to some prime modulo <code>m</code>, in this case <code>7</code> (last parameter in the constructor), leaving us with <code>3</code> as a result. Therefore, for this trigram <code>foo</code>, we would add <code>1</code> to the third row<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>. We can convert this <a href="../../api/special_arrays/#Mill.NGramMatrix"><code>NGramMatrix</code></a> into a sparse array and then to the standard array:</p><pre><code class="language-julia hljs">using SparseArrays</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; hosts_dense = hosts_ngrams |&gt; SparseMatrixCSC |&gt; Matrix</code><code class="nohighlight hljs ansi" style="display:block;">7×6 Matrix{Int64}:
 1  1  3  1  3  1
 1  1  0  1  0  1
 3  3  4  3  4  3
 2  2  1  2  1  2
 3  3  3  3  3  3
 2  2  1  2  1  2
 1  1  1  1  1  1</code></pre><p>Again, we get one column for each string, and the matrix has the same number of rows as modulo <code>m</code>. For each string <code>s</code>, we get <code>length(s) + n - 1</code> <code>n</code>grams:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; sum(hosts_dense; dims=1)</code><code class="nohighlight hljs ansi" style="display:block;">1×6 Matrix{Int64}:
 13  13  13  13  13  13</code></pre><p>This is because we use special abstract characters (or tokens) for the start and the end of the string. If we denote these <code>^</code> and <code>$</code>, respectively, from string <code>&quot;foo&quot;</code>, we get trigrams <code>^^f</code>, <code>^fo</code>, <code>foo</code>, <code>oo$</code>, <code>o$$</code>. Note that these special characters are purely abstract whereas <code>^</code> and <code>$</code> used only for illustration purposes here are characters like any other. Both string start and string end special characters have a unique mapping to integers, which can be obtained as well as set:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; Mill.string_start_code()</code><code class="nohighlight hljs ansi" style="display:block;">0x02</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Mill.string_end_code()</code><code class="nohighlight hljs ansi" style="display:block;">0x03</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Mill.string_start_code!(42)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Mill.string_start_code()</code><code class="nohighlight hljs ansi" style="display:block;">0x2a</code></pre><p><a href="../../api/special_arrays/#Mill.NGramMatrix"><code>NGramMatrix</code></a> behaves like a matrix, implements an efficient left-multiplication and thus can be used in <a href="../../api/data_nodes/#Mill.ArrayNode"><code>ArrayNode</code></a>:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; hosts_ngrams::AbstractMatrix{Int64}</code><code class="nohighlight hljs ansi" style="display:block;">7×6 NGramMatrix{String, Vector{String}, Int64}:
 &quot;www.foo.com&quot;
 &quot;www.foo.com&quot;
 &quot;www.baz.com&quot;
 &quot;www.foo.com&quot;
 &quot;www.baz.com&quot;
 &quot;www.foo.com&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; host_node = ArrayNode(hosts_ngrams)</code><code class="nohighlight hljs ansi" style="display:block;">7×6 ArrayNode{NGramMatrix{String, Vector{String}, Int64}, Nothing}:
 &quot;www.foo.com&quot;
 &quot;www.foo.com&quot;
 &quot;www.baz.com&quot;
 &quot;www.foo.com&quot;
 &quot;www.baz.com&quot;
 &quot;www.foo.com&quot;</code></pre><p><a href="../custom/#Custom-nodes">Custom nodes</a> section shows one more slightly more complex way of processing strings, specifically Unix paths.</p><h2 id="Putting-it-all-together"><a class="docs-heading-anchor" href="#Putting-it-all-together">Putting it all together</a><a id="Putting-it-all-together-1"></a><a class="docs-heading-anchor-permalink" href="#Putting-it-all-together" title="Permalink"></a></h2><p>Now, we can finally put wrap all features of all six connections into one <a href="../../api/data_nodes/#Mill.ProductNode"><code>ProductNode</code></a> and construct a <a href="../../api/data_nodes/#Mill.BagNode"><code>BagNode</code></a> representing a bag of all connections (corresponding to three different clients):</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ds = BagNode(ProductNode(
           numerical=numerical_node,
           verb=verb_node,
           encoding=encoding_node,
           hosts=host_node
       ), connections)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr34">BagNode</span><span class="sgr90"><span class="sgr3">  3 obs</span></span>
<span class="sgr34">  ╰── </span><span class="sgr31">ProductNode</span><span class="sgr90"><span class="sgr3">  6 obs</span></span>
<span class="sgr34">      </span><span class="sgr31">  ├── numerical: </span>ArrayNode(2×6 Array with Int64 elements)<span class="sgr90"><span class="sgr3">  6 obs</span></span>
<span class="sgr34">      </span><span class="sgr31">  ├─────── verb: </span>ArrayNode(5×6 OneHotArray with Bool elements)<span class="sgr90"><span class="sgr3">  6 obs</span></span>
<span class="sgr34">      </span><span class="sgr31">  ├─── encoding: </span>ArrayNode(4×6 OneHotArray with Bool elements)<span class="sgr90"><span class="sgr3">  6 obs</span></span>
<span class="sgr34">      </span><span class="sgr31">  ╰────── hosts: </span>ArrayNode(7×6 NGramMatrix with Int64 elements)<span class="sgr90"><span class="sgr3">  6 obs</span></span></code></pre><p>create a model for training and run one forward pass:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; m = reflectinmodel(ds)</code><code class="nohighlight hljs ansi" style="display:block;"><span class="sgr34">BagModel ↦ BagCount([SegmentedMean(10); SegmentedMax(10)]) ↦ Dense(21 =&gt; 10)</span><span class="sgr90"><span class="sgr3">   </span>⋯</span>
<span class="sgr34">  ╰── </span><span class="sgr31">ProductModel ↦ Dense(40 =&gt; 10)</span><span class="sgr90"><span class="sgr3">  2 arrays, 410 params, 1.688 KiB</span></span>
<span class="sgr34">      </span><span class="sgr31">  ├── numerical: </span>ArrayModel(Dense(2 =&gt; 10))<span class="sgr90"><span class="sgr3">  2 arrays, 30 params, 208 by </span>⋯</span>
<span class="sgr34">      </span><span class="sgr31">  ├─────── verb: </span>ArrayModel(Dense(5 =&gt; 10))<span class="sgr90"><span class="sgr3">  2 arrays, 60 params, 328 by </span>⋯</span>
<span class="sgr34">      </span><span class="sgr31">  ├─── encoding: </span>ArrayModel(Dense(4 =&gt; 10))<span class="sgr90"><span class="sgr3">  2 arrays, 50 params, 288 by </span>⋯</span>
<span class="sgr34">      </span><span class="sgr31">  ╰────── hosts: </span>ArrayModel(Dense(7 =&gt; 10))<span class="sgr90"><span class="sgr3">  2 arrays, 80 params, 408 by </span>⋯</span></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; m(ds)</code><code class="nohighlight hljs ansi" style="display:block;">10×3 Matrix{Float32}:
  1.28439f8   1.23432f8   1.17321f8
 -5.59327f7  -4.71452f7  -8.44016f7
 -7.23352f8  -6.77337f8  -7.52425f8
  3.82563f8   3.63774f8   3.74053f8
 -3.25157f8  -3.05034f8  -3.36274f8
 -1.77164f8  -1.68485f8  -1.74555f8
 -4.77705f8  -4.48281f8  -4.97372f8
  4.16182f7   3.67129f7   4.93028f7
  4.13563f7   4.18648f7   3.00047f7
  3.72453f7   3.75997f7   2.38858f7</code></pre><p>We now obtain a matrix with three columns, each corresponding to one of the clients. Now we can for example calculate gradients with respect to the model parameters:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; gradient(m -&gt; sum(m(ds)), m)</code><code class="nohighlight hljs ansi" style="display:block;">((im = (ms = (numerical = (m = (weight = Float32[3543.7795 3.467772f8; 12015.21 2.9824387f9; … ; -10205.47 -2.5080468f9; -22158.354 -4.05619f9], bias = Float32[0.12283072, 2.3017697, -6.108818, -0.07409614, -2.9991698, 2.245645, -2.9834032, 0.46019074, -1.9266042, -2.8137956], σ = nothing),), verb = (m = (weight = Float32[-0.6740063 -0.70653045 … 0.03252409 0.0; 0.799402 0.48524243 … 0.31415942 0.0; … ; 0.37385964 0.10423415 … 0.26962546 0.0; 1.1983932 0.8594307 … 0.3389626 0.0], bias = Float32[-2.022019, 2.3982058, -1.1765642, -0.78065914, 0.99973947, -2.0380163, 1.3930469, 4.333061, 1.1215789, 3.5951798], σ = nothing),), encoding = (m = (weight = Float32[-0.06326684 0.74241585 0.37819934 -0.15449953; -1.5059438 -0.29936808 -0.8562048 -0.18580464; … ; -1.4919614 -0.3994601 -0.92160493 -0.09642328; 1.679817 -0.015670985 0.7583598 0.2948524], bias = Float32[0.90284884, -2.847321, 4.356851, 0.28094852, -2.0077217, -5.3011537, 3.5605748, -1.0072757, -2.9094498, 2.717358], σ = nothing),), hosts = (m = (weight = Float32[-18.11323 -2.8004198 … -2.8004198 -4.7428136; -5.9066224 -0.88825744 … -0.88825744 -1.5366275; … ; 3.351283 0.6230595 … 0.6230595 0.9194803; -8.199025 -1.2190037 … -1.2190037 -2.1274068], bias = Float32[-4.7428136, -1.5366275, -2.2574577, -0.43867037, 2.0060303, 0.528619, -1.6092172, -0.7405628, 0.9194803, -2.1274068], σ = nothing),)), m = (weight = Float32[-4.019252f8 6.513404f8 … -1.2286562 0.8835508; 5.433767f8 -8.805694f8 … 1.4225271 -1.0247681; … ; 6.43344f8 -1.0425715f9 … 1.6505618 -1.1893108; -3.5949668f7 5.8265244f7 … -0.5622243 0.39958024], bias = Float32[1.9439511, -2.6168752, -7.0138664, 8.038992, -3.5198772, 3.923693, 0.69940704, -0.5939465, -3.09123, -0.07146776], σ = nothing)), a = (a = (fs = ((ψ = Float32[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],), (ψ = Float32[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],)),),), bm = (weight = Float32[-1.05757606f9 4.0311667f8 … -1.6887172f9 3.1780539; -1.05757606f9 4.0311667f8 … -1.6887172f9 3.1780539; … ; -1.05757606f9 4.0311667f8 … -1.6887172f9 3.1780539; -1.05757606f9 4.0311667f8 … -1.6887172f9 3.1780539], bias = Float32[3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0, 3.0], σ = nothing)),)</code></pre><div class="admonition is-category-ukn" id="Numerical-features-a30ad15c70dbc109"><header class="admonition-header">Numerical features<a class="admonition-anchor" href="#Numerical-features-a30ad15c70dbc109" title="Permalink"></a></header><div class="admonition-body"><p>To put all numerical features into one <a href="../../api/data_nodes/#Mill.ArrayNode"><code>ArrayNode</code></a> is a design choice. We could as well introduce more keys in the final <a href="../../api/data_nodes/#Mill.ProductNode"><code>ProductNode</code></a>. The model treats these two cases slightly differently (see <a href="../nodes/#Nodes">Nodes</a> section).</p></div></div><p>This dummy example illustrates the versatility of <a href="https://github.com/CTUAvastLab/Mill.jl"><code>Mill.jl</code></a>. With little to no preprocessing we are able to process complex hierarchical structures and avoid manually designing feature extraction procedures. For a more involved study on processing Internet traffic with <a href="https://github.com/CTUAvastLab/Mill.jl"><code>Mill.jl</code></a>, see for example [<a href="../../references/#Pevny2020">10</a>].</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>One appropriate value for modulo <code>m</code> for real problems is <code>2053</code></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../aggregation/">« Bag aggregation</a><a class="docs-footer-nextpage" href="../missing/">Missing data »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 23 July 2025 10:42">Wednesday 23 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
